library(readxl)
exceldata_158_1109 <- read_excel("data/exceldata_158_1109.xlsx",
sheet = "sheet2")
View(exceldata_158_1109)
library(readxl)
exceldata_158_1109 <- read_excel("data/exceldata_158_1109.xlsx",
sheet = "sheet1_1_全員回答")
library(readxl)
exceldata_158_1109 <- read_excel("data/exceldata_158_1109.xlsx",
sheet = "sheet1_1_全員回答")
View(exceldata_158_1109)
View(exceldata_158_1109)
library(readxl)
exceldata_158_1109 <- read_excel("data/exceldata_158_1109.xlsx",
sheet = "sheet1_1_全員回答")
View(exceldata_158_1109)
# 整形
## ダミー変数化
exceldata_158_1109$`コンシューマーゲームで遊びますか。` <- as.numeric(exceldata_158_1109$`コンシューマーゲームで遊びますか。` == "はい")
exceldata_158_1109$`PCゲームで遊びますか。` <- as.numeric(exceldata_158_1109$`PCゲームで遊びますか。` == "はい")
exceldata_158_1109$`ゲームセンターのアーケードゲームで遊びますか。` <- as.numeric(exceldata_158_1109$`ゲームセンターのアーケードゲームで遊びますか。` == "はい")
library(readxl)
df <- read_excel("data/exceldata_158_1109.xlsx",
sheet = "sheet1_1_全員回答")
df <- read_excel("data/exceldata_158_1109.xlsx",
sheet = "sheet1_1_全員回答")
View(df)
# 整形
## ダミー変数化
df$`コンシューマーゲームで遊びますか。` <- as.numeric(df$`コンシューマーゲームで遊びますか。` == "はい")
df$`PCゲームで遊びますか。` <- as.numeric(df$`PCゲームで遊びますか。` == "はい")
df$`ゲームセンターのアーケードゲームで遊びますか。` <- as.numeric(df$`ゲームセンターのアーケードゲームで遊びますか。` == "はい")
stress_map <- c("全く感じない", "少し感じる", "強く感じる")
df$stress_factor <- factor(df$日常のストレス強度, levels = stress_map)
df <- read_excel("data/exceldata_158_1109.xlsx",
sheet = "sheet1_1_全員回答")
View(df)
# 整形
## ダミー変数化
df$`コンシューマーゲームで遊びますか。` <- as.numeric(df$`コンシューマーゲームで遊びますか。` == "はい")
df$`PCゲームで遊びますか。` <- as.numeric(df$`PCゲームで遊びますか。` == "はい")
df$`ゲームセンターのアーケードゲームで遊びますか。` <- as.numeric(df$`ゲームセンターのアーケードゲームで遊びますか。` == "はい")
stress_map <- c("全く感じない", "少し感じる", "強く感じる")
df$日常のストレス強度 <- factor(df$日常のストレス強度, levels = stress_map)
df$日常のストレス強度 <- as.numeric(df$日常のストレス強度) - 1
frequency_map <- c("選ばない", "あまり選ばない", "たまに選ぶ", "頻繁に選ぶ")
df$スポーツをする <- as.numeric(
factor(df$スポーツをする, levels = frequency_map)
)
View(df)
df <- read_excel("data/exceldata_158_1109.xlsx",
sheet = "sheet1_1_全員回答")
# 整形
## ダミー変数化
df$`コンシューマーゲームで遊びますか。` <- as.numeric(df$`コンシューマーゲームで遊びますか。` == "はい")
df$`PCゲームで遊びますか。` <- as.numeric(df$`PCゲームで遊びますか。` == "はい")
df$`ゲームセンターのアーケードゲームで遊びますか。` <- as.numeric(df$`ゲームセンターのアーケードゲームで遊びますか。` == "はい")
stress_map <- c("全く感じない", "少し感じる", "強く感じる")
df$日常のストレス強度 <- factor(df$日常のストレス強度, levels = stress_map)
df$日常のストレス強度 <- as.numeric(df$日常のストレス強度) - 1
frequency_map <- c("選ばない", "あまり選ばない", "たまに選ぶ", "頻繁に選ぶ")
df$スポーツをする <- as.numeric(
factor(df$スポーツをする, levels = frequency_map)
)-1
df$散歩 <- as.numeric(
factor(df$散歩, levels = frequency_map)
)-1
df$ゲーム <- as.numeric(
factor(df$ゲーム, levels = frequency_map)
)-1
df$`サウナ・整体` <- as.numeric(
factor(df$`サウナ・整体`, levels = frequency_map)
)-1
df$映画鑑賞 <- as.numeric(
factor(df$映画鑑賞, levels = frequency_map)
)-1
df$友人や家族のコミュニケーション <- as.numeric(
factor(df$友人や家族のコミュニケーション, levels = frequency_map)
)-1
df$ショッピング <- as.numeric(
factor(df$ショッピング, levels = frequency_map)
)-1
df$賭け事 <- as.numeric(
factor(df$賭け事, levels = frequency_map)
)-1
df$カラオケ <- as.numeric(
factor(df$カラオケ, levels = frequency_map)
)-1
df$睡眠 <- as.numeric(
factor(df$睡眠, levels = frequency_map)
)-1
# dplyrパッケージをロード
library(dplyr)
#「SNSを見る」から「その他アウトドアの趣味」までの全ての列に対して「- 1」の操作を適用する
df <- df %>%
mutate(
across(
# 列の範囲を「開始列名:終了列名」で指定
`ゲーム（スマホ利用）`:`その他アウトドアの趣味`,
# 適用する関数を指定 (ここでは、現在の列の値から1を引く)
~ .x - 1
)
)
## スマホゲームで遊ぶは1、それ以外は0
df$`あなたはスマートフォンゲームで遊びますか。` <- as.numeric(df$`あなたはスマートフォンゲームで遊びますか。` == "遊ぶ")
install.packages("writexl")
# パッケージのインストール (初回のみ)
# install.packages("writexl")
# 出力
library(writexl)
write_xlsx(df, "data/data_1.xlsx")
library(readxl)
data_1 <- read_excel("data/data_1.xlsx",
sheet = "Sheet1")
View(data_1)
Result <- prcomp(data_1, scale = FALSE)	# 分散共分散行列による主成分分析を実行し，結果をResultに格納
library(readxl)
data_1 <- read_excel("data/data_1.xlsx",
sheet = "Sheet1")
data <- data_1[data_1$`ゲーム（スマホ利用）`:data_1$`ショッピング（スマホ利用）`]
View(data)
data <- data_1[11:19]
data
Result <- prcomp(data, scale = FALSE)	# 分散共分散行列による主成分分析を実行し，結果をResultに格納
Result		# 各主成分の固有値のルート(=相関係数)と，各主成分係数(Rotation)の表示
Result$sdev^2	# 固有値の計算
summary(Result)		# 寄与率(Proportion of Variance)，累積寄与率の表示
Loadings <- cor(Data, Result$x)	# 主成分負荷量
Loadings <- cor(data, Result$x)	# 主成分負荷量
Result$x	# 主成分得点の表示
plot(Loadings[, 1], Loadings[, 2], type = "n",
xlim = c(-1, 1), ylim = c(-1, 1), xlab = "第1主成分負荷量", ylab = "第2主成分負荷量")
# 第1主成分負荷量と第2主成分負荷量の散布図の作成
text(Loadings[, 1], Loadings[, 2], rownames(Loadings))
plot(Result$x[, 1], Result$x[, 2], type = "n",
xlim = c(-60, 60), ylim = c(-60, 60), xlab = "第1主成分得点", ylab = "第2主成分得点")
text(Result$x[, 1], Result$x[, 2], 1:15)	# 第1主成分得点と第2主成分得点の散布図の作成
plot(Result$x[, 1], Result$x[, 2], type = "n",
xlim = c(-20, 20), ylim = c(-20, 20), xlab = "第1主成分得点", ylab = "第2主成分得点")
text(Result$x[, 1], Result$x[, 2], 1:15)	# 第1主成分得点と第2主成分得点の散布図の作成
plot(Result$x[, 1], Result$x[, 2], type = "n",
xlim = c(-5, 5), ylim = c(-5, 5), xlab = "第1主成分得点", ylab = "第2主成分得点")
text(Result$x[, 1], Result$x[, 2], 1:15)	# 第1主成分得点と第2主成分得点の散布図の作成
Loadings
Loadings
source("C:/Users/hiwas/Ocha/game/20251109_2.R")
# 第3主成分負荷量と第4主成分負荷量の散布図の作成
plot(Loadings[, 3], Loadings[, 4], type = "n",
xlim = c(-1, 1), ylim = c(-1, 1), xlab = "第3主成分負荷量", ylab = "第4主成分負荷量")
text(Loadings[, 3], Loadings[, 4], rownames(Loadings))
# 第1主成分負荷量と第2主成分負荷量の散布図の作成
plot(Loadings[, 1], Loadings[, 2], type = "n",
xlim = c(-1, 1), ylim = c(-1, 1), xlab = "第1主成分負荷量", ylab = "第2主成分負荷量")
text(Loadings[, 1], Loadings[, 2], rownames(Loadings))
# 第3主成分負荷量と第4主成分負荷量の散布図の作成
plot(Loadings[, 3], Loadings[, 4], type = "n",
xlim = c(-1, 1), ylim = c(-1, 1), xlab = "第3主成分負荷量", ylab = "第4主成分負荷量")
text(Loadings[, 3], Loadings[, 4], rownames(Loadings))
# クラスタリング
## 第1〜第4主成分の得点を取り出す
pca_scores <- Result$x[, 1:4]
set.seed(123)  # 再現性のため
clusters <- kmeans(pca_scores, centers = 3)
# 結果を確認
table(clusters$cluster)
library(ggplot2)
df_plot <- data.frame(pca_scores[, 1:2],
cluster = as.factor(clusters$cluster))
ggplot(df_plot, aes(x = PC1, y = PC2, color = cluster)) +
geom_point(size = 3, alpha = 0.7) +
labs(title = "スマホ利用傾向のクラスタリング（PC1×PC2）",
x = "第1主成分（利用全般の多さ）",
y = "第2主成分（SNS中心 vs 鑑賞・読書中心）") +
theme_minimal()
## クラスター数の決定
wss <- numeric(10)
for (k in 1:10) {
wss[k] <- sum(kmeans(pca_scores, centers = k, nstart = 10)$withinss)
}
plot(1:10, wss, type = "b",
xlab = "クラスター数 k",
ylab = "クラスタ内分散 (WSS)",
main = "エルボー法による最適クラスタ数の確認")
source("C:/Users/hiwas/Ocha/game/20251109_2.R")
source("C:/Users/hiwas/Ocha/game/20251109_2.R")
df_plot <- data.frame(pca_scores[, 1:2],
cluster = as.factor(clusters$cluster))
ggplot(df_plot, aes(x = PC1, y = PC2, color = cluster)) +
geom_point(size = 3, alpha = 0.7) +
labs(title = "スマホ利用傾向のクラスタリング（PC1×PC2）",
x = "第1主成分（利用全般の多さ）",
y = "第2主成分（SNS中心 vs 鑑賞・読書中心）") +
theme_minimal()
df_plot <- data.frame(pca_scores[, 3:4],
cluster = as.factor(clusters$cluster))
ggplot(df_plot, aes(x = PC3, y = PC4, color = cluster)) +
geom_point(size = 3, alpha = 0.7) +
labs(title = "スマホ利用傾向のクラスタリング（PC3×PC4）",
x = "第3主成分（能動的学習・娯楽 vs 受動的鑑賞）",
y = "第4主成分（娯楽・遊び型 vs 学習・生産型）") +
theme_minimal()
## 各クラスタでどの主成分が強いのか？
aggregate(pca_scores, by=list(cluster=clusters$cluster), mean)
source("C:/Users/hiwas/Ocha/game/20251109_2.R")
source("C:/Users/hiwas/Ocha/game/20251109_2.R")
source("C:/Users/hiwas/Ocha/game/20251109_2.R")
data_1 <- read_excel("data/data_1.xlsx",
sheet = "Sheet1")
View(data_1)
data <- data_1[30:39]
Result <- prcomp(data, scale = TRUE)	# 相関係数行列による主成分分析を実行し，結果をResultに格納
Result		# 各主成分の固有値のルート(=相関係数)と，各主成分係数(Rotation)の表示
Result$sdev^2	# 固有値の計算
summary(Result)		# 寄与率(Proportion of Variance)，累積寄与率の表示
# 第1主成分負荷量と第2主成分負荷量の散布図の作成
plot(Loadings[, 1], Loadings[, 2], type = "n",
xlim = c(-1, 1), ylim = c(-1, 1), xlab = "第1主成分負荷量", ylab = "第2主成分負荷量")
text(Loadings[, 1], Loadings[, 2], rownames(Loadings))
source("C:/Users/hiwas/Ocha/game/20251109_2.R")
library(readxl)
data_1 <- read_excel("data/data_1.xlsx",
sheet = "Sheet1")
View(data_1)
data <- data_1[30:39]
Result <- prcomp(data, scale = TRUE)	# 分散共分散行列による主成分分析を実行し，結果をResultに格納
Result <- prcomp(data, scale = TRUE)	# 相関係数行列による主成分分析を実行し，結果をResultに格納
Result		# 各主成分の固有値のルート(=相関係数)と，各主成分係数(Rotation)の表示
summary(Result)		# 寄与率(Proportion of Variance)，累積寄与率の表示
Loadings <- cor(data, Result$x)	# 主成分負荷量
Result$x	# 主成分得点の表示
# 第1主成分負荷量と第2主成分負荷量の散布図の作成
plot(Loadings[, 1], Loadings[, 2], type = "n",
xlim = c(-1, 1), ylim = c(-1, 1), xlab = "第1主成分負荷量", ylab = "第2主成分負荷量")
text(Loadings[, 1], Loadings[, 2], rownames(Loadings))
# 第3主成分負荷量と第4主成分負荷量の散布図の作成
plot(Loadings[, 3], Loadings[, 4], type = "n",
xlim = c(-1, 1), ylim = c(-1, 1), xlab = "第3主成分負荷量", ylab = "第4主成分負荷量")
text(Loadings[, 3], Loadings[, 4], rownames(Loadings))
# クラスタリング
## 第1〜第4主成分の得点を取り出す
pca_scores <- Result$x[, 1:4]
# 結果を確認
table(clusters$cluster)
## クラスター数の決定
wss <- numeric(10)
for (k in 1:10) {
wss[k] <- sum(kmeans(pca_scores, centers = k, nstart = 10)$withinss)
}
plot(1:10, wss, type = "b",
xlab = "クラスター数 k",
ylab = "クラスタ内分散 (WSS)",
main = "エルボー法による最適クラスタ数の確認")
library(ggplot2)
df_plot <- data.frame(pca_scores[, 1:2],
cluster = as.factor(clusters$cluster))
ggplot(df_plot, aes(x = PC1, y = PC2, color = cluster)) +
geom_point(size = 3, alpha = 0.7) +
labs(title = "スマホ利用傾向のクラスタリング（PC1×PC2）",
x = "第1主成分（利用全般の多さ）",
y = "第2主成分（SNS中心 vs 鑑賞・読書中心）") +
theme_minimal()
df_plot <- data.frame(pca_scores[, 3:4],
cluster = as.factor(clusters$cluster))
ggplot(df_plot, aes(x = PC3, y = PC4, color = cluster)) +
geom_point(size = 3, alpha = 0.7) +
labs(title = "スマホ利用傾向のクラスタリング（PC3×PC4）",
x = "第3主成分（能動的学習・娯楽 vs 受動的鑑賞）",
y = "第4主成分（娯楽・遊び型 vs 学習・生産型）") +
theme_minimal()
## 各クラスタでどの主成分が強いのか？
aggregate(pca_scores, by=list(cluster=clusters$cluster), mean)
ggplot(df_plot, aes(x = PC1, y = PC2, color = cluster)) +
geom_point(size = 3, alpha = 0.7) +
labs(title = "スマホ利用傾向のクラスタリング（PC1×PC2）",
x = "第1主成分（利用全般の多さ）",
y = "第2主成分（SNS中心 vs 鑑賞・読書中心）") +
theme_minimal()
df_plot <- data.frame(pca_scores[, 1:2],
cluster = as.factor(clusters$cluster))
ggplot(df_plot, aes(x = PC1, y = PC2, color = cluster)) +
geom_point(size = 3, alpha = 0.7) +
labs(title = "スマホ利用傾向のクラスタリング（PC1×PC2）",
x = "第1主成分（利用全般の多さ）",
y = "第2主成分（SNS中心 vs 鑑賞・読書中心）") +
theme_minimal()
ggplot(df_plot, aes(x = PC3, y = PC4, color = cluster)) +
geom_point(size = 5, alpha = 0.7) +
labs(title = "スマホ利用傾向のクラスタリング（PC3×PC4）",
x = "第3主成分（能動的学習・娯楽 vs 受動的鑑賞）",
y = "第4主成分（娯楽・遊び型 vs 学習・生産型）") +
theme_minimal()
df_plot <- data.frame(pca_scores[, 1:2],
cluster = as.factor(clusters$cluster))
ggplot(df_plot, aes(x = PC1, y = PC2, color = cluster)) +
geom_point(size = 5, alpha = 0.7) +
labs(title = "スマホ利用傾向のクラスタリング（PC1×PC2）",
x = "第1主成分（利用全般の多さ）",
y = "第2主成分（SNS中心 vs 鑑賞・読書中心）") +
theme_minimal()
ggplot(df_plot, aes(x = PC1, y = PC2, color = cluster)) +
geom_point(size = 5, alpha = 0.7) +
labs(title = "スマホ利用傾向のクラスタリング（PC1×PC2）",
x = "第1主成分（利用全般の多さ）",
y = "第2主成分（SNS中心 vs 鑑賞・読書中心）") +
theme_minimal()
ggplot(df_plot, aes(x = PC1, y = PC2, color = cluster)) +
geom_point(size = 4, alpha = 0.7) +
labs(title = "スマホ利用傾向のクラスタリング（PC1×PC2）",
x = "第1主成分（利用全般の多さ）",
y = "第2主成分（SNS中心 vs 鑑賞・読書中心）") +
theme_minimal()
ggplot(df_plot, aes(x = PC1, y = PC2, color = cluster)) +
geom_point(size = 3, alpha = 0.7) +
labs(title = "スマホ利用傾向のクラスタリング（PC1×PC2）",
x = "第1主成分（利用全般の多さ）",
y = "第2主成分（SNS中心 vs 鑑賞・読書中心）") +
theme_minimal()
ggplot(df_plot, aes(x = PC1, y = PC2, color = cluster)) +
geom_point(size = 2, alpha = 0.7) +
labs(title = "スマホ利用傾向のクラスタリング（PC1×PC2）",
x = "第1主成分（利用全般の多さ）",
y = "第2主成分（SNS中心 vs 鑑賞・読書中心）") +
theme_minimal()
ggplot(df_plot, aes(x = PC1, y = PC2, color = cluster)) +
geom_point(size = 3, alpha = 0.7) +
labs(title = "スマホ利用傾向のクラスタリング（PC1×PC2）",
x = "第1主成分（利用全般の多さ）",
y = "第2主成分（SNS中心 vs 鑑賞・読書中心）") +
theme_minimal()
Result <- prcomp(data, scale = TRUE)	# 相関係数行列による主成分分析を実行し，結果をResultに格納
Result$sdev^2	# 固有値の計算
summary(Result)		# 寄与率(Proportion of Variance)，累積寄与率の表示
Loadings <- cor(data, Result$x)	# 主成分負荷量
Result$x	# 主成分得点の表示
# 第1主成分負荷量と第2主成分負荷量の散布図の作成
plot(Loadings[, 1], Loadings[, 2], type = "n",
xlim = c(-1, 1), ylim = c(-1, 1), xlab = "第1主成分負荷量", ylab = "第2主成分負荷量")
text(Loadings[, 1], Loadings[, 2], rownames(Loadings))
Loadings
View(data_1)
data <- data_1[11:19]
data
source("C:/Users/hiwas/Ocha/game/20251109_2.R")
data <- data_1[30:39]
data
data <- data[-4:]
data <- data[-4:,]
data <- data[-4:, ]
data <- data[, -4]
data
data <- data[, -7]
data
Result <- prcomp(data, scale = TRUE)	# 相関係数行列による主成分分析を実行し，結果をResultに格納
Result$sdev^2	# 固有値の計算
summary(Result)		# 寄与率(Proportion of Variance)，累積寄与率の表示
summary(Result)		# 寄与率(Proportion of Variance)，累積寄与率の表示
Loadings <- cor(data, Result$x)	# 主成分負荷量
Loadings
# 第1主成分負荷量と第2主成分負荷量の散布図の作成
plot(Loadings[, 1], Loadings[, 2], type = "n",
xlim = c(-1, 1), ylim = c(-1, 1), xlab = "第1主成分負荷量", ylab = "第2主成分負荷量")
text(Loadings[, 1], Loadings[, 2], rownames(Loadings))
# 第3主成分負荷量と第4主成分負荷量の散布図の作成
plot(Loadings[, 3], Loadings[, 4], type = "n",
xlim = c(-1, 1), ylim = c(-1, 1), xlab = "第3主成分負荷量", ylab = "第4主成分負荷量")
text(Loadings[, 3], Loadings[, 4], rownames(Loadings))
# クラスタリング
## 第1〜第4主成分の得点を取り出す
pca_scores <- Result$x[, 1:4]
clusters <- kmeans(pca_scores, centers = 3)
# 結果を確認
table(clusters$cluster)
set.seed(123)  # 再現性のため
clusters <- kmeans(pca_scores, centers = 3)
# 結果を確認
table(clusters$cluster)
## クラスター数の決定
wss <- numeric(10)
for (k in 1:10) {
wss[k] <- sum(kmeans(pca_scores, centers = k, nstart = 10)$withinss)
}
plot(1:10, wss, type = "b",
xlab = "クラスター数 k",
ylab = "クラスタ内分散 (WSS)",
main = "エルボー法による最適クラスタ数の確認")
library(ggplot2)
df_plot <- data.frame(pca_scores[, 1:2],
cluster = as.factor(clusters$cluster))
ggplot(df_plot, aes(x = PC1, y = PC2, color = cluster)) +
geom_point(size = 3, alpha = 0.7) +
labs(title = "スマホ利用傾向のクラスタリング（PC1×PC2）",
x = "第1主成分（利用全般の多さ）",
y = "第2主成分（SNS中心 vs 鑑賞・読書中心）") +
theme_minimal()
df_plot <- data.frame(pca_scores[, 3:4],
cluster = as.factor(clusters$cluster))
ggplot(df_plot, aes(x = PC3, y = PC4, color = cluster)) +
geom_point(size = 3, alpha = 0.7) +
labs(title = "スマホ利用傾向のクラスタリング（PC3×PC4）",
x = "第3主成分（能動的学習・娯楽 vs 受動的鑑賞）",
y = "第4主成分（娯楽・遊び型 vs 学習・生産型）") +
theme_minimal()
## 各クラスタでどの主成分が強いのか？
aggregate(pca_scores, by=list(cluster=clusters$cluster), mean)
library(readxl)
exceldata <- read_excel("data/exceldata_158_1109.xlsx", sheet = "sheet1")
View(exceldata)
# ゲームで遊ぶ人の回答を抽出
df <- exceldata[ecxeldata[, 5]=="遊ぶ", ]
# ゲームで遊ぶ人の回答を抽出
df <- exceldata[exceldata[, 5]=="遊ぶ", ]
d
df
exceldata <- read_excel("data/exceldata_158_1109.xlsx", sheet = "sheet1")
# ゲームで遊ぶ人の回答を抽出
df <- exceldata[exceldata[, 5]=="遊ぶ", ]
View(df)
# ゲームで遊ぶ人の回答を抽出
df <- exceldata[exceldata[, 5]=="遊ぶ", -5]
View(df)
exceldata <- read_excel("data/exceldata_158_1109.xlsx", sheet = "sheet1_2_SPGame")
View(exceldata)
# ゲームで遊ぶ人の回答を抽出
df <- exceldata[exceldata[, 5]=="遊ぶ", -5]
View(df)
## 数値化
played_map <- c("遊んだことがない", "少し遊んだことがある", "頻繁に遊んでいた")
df$Played_Before_Console <- as.numeric(
factor(df$Played_Before_Console, levels = played_map)
)-1
df$Played_Before_PC <- as.numeric(
factor(df$Played_Before_PC, levels = played_map)
)-1
df$Played_Before_Arcade <- as.numeric(
factor(df$Played_Before_Arcade, levels = played_map)
)-1
situ_frequency_map <- c("全くしない", "たまにする", "頻繁にする")
df <- df %>%
mutate(
across(
.cols = c(14:17),
.fns = ~ as.numeric(factor(., levels = situ_frequency_map)) - 1
)
)
library(dplyr)
df <- df %>%
mutate(
across(
.cols = c(14:17),
.fns = ~ as.numeric(factor(., levels = situ_frequency_map)) - 1
)
)
importance_map <- c("全く思わない", "あまり思わない", "思う", "とても思う")
df <- df %>%
mutate(
across(
.cols = c(20:37),
.fns = ~ as.numeric(factor(., levels = importance_map)) - 1
)
)
# ダミー変数化
df$Purchased_Paid_SPG <- as.numeric(df$Purchased_Paid_SPG == "ある")
df$Made_InApp_Purchase <- as.numeric(df$Made_InApp_Purchase == "ない")
df$Impact_Oshi_Character <- as.numeric(df$Impact_Oshi_Character == "いる")
df$Play_on_Tablet <- as.numeric(df$Play_on_Tablet == "遊ぶ")
df$Play_Console <- as.numeric(df$Play_Console == "はい")
df$Play_PC <- as.numeric(df$Play_PC == "はい")
df$Play_Arcade <- as.numeric(df$Play_Arcade == "はい")
df$Play_Arcade <- as.numeric(df$Play_Arcade == "はい")
# 出力
library(writexl)
write_xlsx(df, "data/data_2.xlsx")
